# /etc/network/interfaces template for switches (<%=@hostname%>)
# Created by Ansible

auto lo
iface lo inet loopback
  address <%=@intvars['loopback']%>/32

auto eth0
iface eth0 inet dhcp

<% @intvars['neighbors'].each do |name, iface| -%>
auto <%=name%>
iface <%=name%>
    address <%=iface['ip']%>

<% end %>


<% (@intvars['networks'] or []).each do |name, network| -%>
<% network['ports'].each do |name2, port| -%>
auto <%= name2 %>
iface <%= name2 %>

<% end %>
auto <%= name %>
iface <%= name %>
    bridge-ports <%= network['ports'].keys().join(' ') %>
    address <%= network['ip'] %>
<% end %>
